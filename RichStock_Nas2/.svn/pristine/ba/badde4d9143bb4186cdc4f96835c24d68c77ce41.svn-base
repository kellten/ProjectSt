Imports PaikRichStock.Common.KiCodeGroup
Imports System.IO

Public Class ucMainStockVer2
    Public _allStockDataset As DataSet      ' 전체 종목
    Public _KospiStockDataset As DataSet    ' 코스피 종목
    Public _KosDakStockDataset As DataSet   ' 코스닥 종목

    Private _clsKiwoomBaseInfo As New clsKiwoomBaseInfo

#Region " Logger "
    Private Enum LoggerType
        Connect
        RealData
        ScreeNo
        Order
        NotRealData
        OnMsg
    End Enum

    Public _sLogger As New DataTable

    Public Sub InitsLogger()
        With _sLogger.Columns
            .Add("LOGGER_TYPE")
            .Add("MESSAGE")
            .Add("MESSAGE_NAME")
            .Add("STOCK_CODE")
        End With
    End Sub

    Private Sub Logger(ByVal loggerType As LoggerType, ByVal message As String, ByVal messageName As String, ByVal stockCode As String)
        Dim dr As DataRow
        Dim ClickTime As Date
        Dim sysTime As String
        ClickTime = Date.Now
        sysTime = ClickTime.Hour & ":" & ClickTime.Minute & ":" & ClickTime.Second

        ''' 나중에 삭제할 구문
        With _sLogger
            dr = .Rows.Add

            dr("LOGGER_TYPE") = loggerType
            dr("MESSAGE") = message
            dr("MESSAGE_NAME") = messageName
            dr("STOCK_CODE") = stockCode

        End With

        Dim sLog As String = ""

        Select Case loggerType
            Case loggerType.Connect
                sLog = "접속정보" & Space(5) & sysTime & Space(5) & message & Space(5) & messageName & Space(5) & "(" & stockCode & ")"

                File_Write(sLog)
            Case loggerType.RealData
                sLog = "실시간" & Space(5) & sysTime & Space(5) & message & Space(5) & messageName & Space(5) & "(" & stockCode & ")"

                File_Write(sLog)
            Case loggerType.ScreeNo
                sLog = "화면번호" & Space(5) & sysTime & Space(5) & message & Space(5) & messageName & Space(5) & "(" & stockCode & ")"

                File_Write(sLog)
            Case loggerType.Order
                sLog = "주문" & Space(5) & sysTime & Space(5) & message & Space(5) & messageName & Space(5) & "(" & stockCode & ")"

                File_Write(sLog)
            Case loggerType.NotRealData
                sLog = "일반" & Space(5) & sysTime & Space(5) & message & Space(5) & messageName & Space(5) & "(" & stockCode & ")"

                File_Write(sLog)

            Case loggerType.OnMsg
                sLog = "OnMsg" & Space(5) & sysTime & Space(5) & message & Space(5) & messageName & Space(5) & "(" & stockCode & ")"

                File_Write(sLog)

        End Select

    End Sub

    Public Sub File_Write(ByVal sSet_Log As String)

        Dim FPath As String

        Dim FName As String

        Dim FDate As String

        Dim FsLog As StreamWriter

        FDate = DateTime.Now.ToString

        FDate = FDate.Substring(0, 11)

        FName = "sLog_" + FDate + ".ini"

        FPath = Path.GetFullPath(FName)

        If File.Exists(FPath) = False Then

            FsLog = File.CreateText(FPath)

        Else

            FsLog = File.AppendText(FPath)

        End If

        Log(sSet_Log, FsLog)

        FsLog.Close()

    End Sub

    Public Sub Log(ByVal logMessage As String, ByVal FsLog As TextWriter)

        'FsLog.WriteLine(ControlChars.CrLf & "Log Entry: ") 줄바꿈 문자

        FsLog.WriteLine(logMessage)

        FsLog.Flush()

    End Sub
#End Region

#Region "화면번호 관리 "
    Public _DtScreenNoManage As New DataTable

    Public Enum Enum_ScreenNo
        TR_OPT1
        TR_OPT1_MARKET
        TR_OPT2
        TR_ORDER
        TR_REAL
        TR_CONDITION
        TR_CONDITIONLIST
    End Enum

    Public Sub InitDtScreenNoManage()
        With _DtScreenNoManage.Columns
            .Add("SCREEN_NO")
            .Add("TR_TYPE")
            .Add("TR_NAME")
            .Add("STOCK_CODE")
        End With
    End Sub

    Public Sub DisconnectRealData(ByVal ScreenNo As String)
        Dim dr As DataRow
        Dim blnTrue As Boolean

        For row As Integer = _dtOptKWFidScreenNo.Rows.Count - 1 To 0 Step -1
            dr = _DtScreenNoManage.Rows(row)

            If dr("SCREEN_NO").ToString.Trim = ScreenNo Then
                _DtScreenNoManage.Rows.RemoveAt(row)
                blnTrue = True
            End If
        Next

        If blnTrue = True Then
            AxKH.DisconnectRealData(ScreenNo)
        End If
    End Sub

    Public Function ScreenNoManage(ByVal enumScreenNo As Enum_ScreenNo, ByVal trName As String, ByVal stockCode As String) As String
        Dim screenNo As String = ""
        Dim dr As DataRow
        Dim drReader As DataRow
        Dim blnExists As Boolean = False

        Try

            With _DtScreenNoManage

                If .Rows.Count < 1 Then
                    dr = .Rows.Add

                    dr("SCREEN_NO") = "1001"
                    dr("TR_TYPE") = enumScreenNo
                    dr("TR_NAME") = trName
                    dr("STOCK_CODE") = stockCode

                Else
                    For i As Integer = 1001 To 1200

                        blnExists = False

                        For Each drReader In .Rows
                            If Trim(drReader("SCREEN_NO").ToString()) = i.ToString() Then
                                blnExists = True
                                Exit For
                            End If
                        Next

                        If blnExists = False Then

                            dr = .Rows.Add

                            dr("SCREEN_NO") = Trim(i.ToString())
                            dr("TR_TYPE") = enumScreenNo
                            dr("TR_NAME") = trName
                            dr("STOCK_CODE") = stockCode

                            screenNo = Trim(i.ToString())

                            Exit For
                        End If
                    Next

                End If

            End With

            Return screenNo

        Catch ex As Exception
            MsgBox(ex.ToString, MsgBoxStyle.Exclamation)
        End Try

        Return ""

    End Function

#End Region

#Region "1. 접속"

    Private _loginStatus As LoginStatus = LoginStatus.DisConnect

#Region " 접속Main "
    ''' <summary>
    ''' C:\Kiwoom\KiwoomFlash2\khministarter.exe 를 통해 접속한다.
    ''' </summary>
    ''' <remarks></remarks>
    Public Sub Connection()
        If _loginStatus = LoginStatus.DisConnect Then
            AxKH.CommConnect()
            Logger(LoggerType.Connect, "접속요청", "Connection", "")

        Else
            MsgBox("이미 접속 해제 상태입니다.")
            Exit Sub
        End If
    End Sub

    Public Sub DisConnection()
        If _loginStatus = LoginStatus.DisConnect Then
            MsgBox("이미 접속 상태입니다.")
        Else
            AxKH.CommTerminate()
            Logger(LoggerType.Connect, "접속해제요청", "DisConnection", "")
            _loginStatus = LoginStatus.DisConnect
        End If
    End Sub

#End Region

#Region " Control Event "
    Private Sub btnDisconnect_Click(sender As Object, e As EventArgs) Handles btnDisconnect.Click
        Connection()
    End Sub

    Private Sub btnConnect_Click(sender As Object, e As EventArgs) Handles btnConnect.Click
        DisConnection()
    End Sub
#End Region

#End Region

#Region "2. Opt함수 "

#Region " 종목코드별 "
    Public Sub Opt10001_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10001_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("주식기본정보", "opt10001", "0", screenNum)
        Logger(LoggerType.NotRealData, "주식기본정보 송신" & "(" & stockName & ")", "Opt10001_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10002_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10002_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("주식거래원요청", "OPT10002", "0", screenNum)
        Logger(LoggerType.NotRealData, "주식거래원요청 송신" & "(" & stockName & ")", "Opt10002_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10003_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10003_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("체결정보요청", "opt10003", "0", screenNum)
        Logger(LoggerType.NotRealData, "체결정보요청 송신" & "(" & stockName & ")", "Opt10003_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10004_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10004_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("주식호가요청", "opt10004", "0", screenNum)
        Logger(LoggerType.NotRealData, "주식호가요청 송신" & "(" & stockName & ")", "Opt10004_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10005_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10005_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("주식일주월시분요청  ", "opt10005", "0", screenNum)
        Logger(LoggerType.NotRealData, "주식일주월시분요청 송신" & "(" & stockName & ")", "Opt10005_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10006_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10006_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("주식시분요청", "Opt10006", "0", screenNum)
        Logger(LoggerType.NotRealData, "주식시분요청 송신" & "(" & stockName & ")", "Opt10006_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10007_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10007_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("시세표성정보요청", "Opt10007", "0", screenNum)
        Logger(LoggerType.NotRealData, "시세표성정보요청 송신" & "(" & stockName & ")", "Opt10007_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10008_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10008_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("주식외국인요청 ", "Opt10008", "0", screenNum)
        Logger(LoggerType.NotRealData, "주식외국인요청 송신" & "(" & stockName & ")", "Opt10008_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10009_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10009_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("주식기관요청", "Opt10009", "0", screenNum)
        Logger(LoggerType.NotRealData, "주식기관요청 송신" & "(" & stockName & ")", "Opt10009_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10010_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10010_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("업종프로그램요청", "Opt10010", "0", screenNum)
        Logger(LoggerType.NotRealData, "업종프로그램요청 송신" & "(" & stockName & ")", "Opt10010_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10011_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10011_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.CommRqData("투자자정보요청", "Opt10011", "0", screenNum)
        Logger(LoggerType.NotRealData, "투자자정보요청 송신" & "(" & stockName & ")", "Opt10011_OnReceiveTrData", stockCode)

    End Sub

    ''' <summary>
    ''' 신용매매동향요청
    ''' </summary>
    ''' <param name="searchGb">1 - 융자 2 - 대주</param>
    ''' <remarks></remarks>
    Public Sub Opt10013_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String, ByVal stdDate As String, ByVal searchGb As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10013_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.SetInputValue("일자", stdDate)
        AxKH.SetInputValue("조회구분", searchGb)
        AxKH.CommRqData("신용매매동향요청", "Opt10013", "0", screenNum)
        Logger(LoggerType.NotRealData, "신용매매동향요청 송신" & "(" & stockName & ")", "Opt10013_OnReceiveTrData", stockCode)

    End Sub

    ''' <summary>
    ''' 공매도추이요청
    ''' </summary>
    ''' <param name="timeGb"> 0:시작일, 1:기간</param>
    ''' <remarks></remarks>
    Public Sub Opt10014_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String, ByVal timeGb As String, ByVal fromDate As String, ByVal toDate As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10014_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.SetInputValue("시간구분", timeGb)
        AxKH.SetInputValue("시작일자", fromDate)
        AxKH.SetInputValue("종료일자", toDate)
        AxKH.CommRqData("공매도추이요청", "Opt10014", "0", screenNum)
        Logger(LoggerType.NotRealData, "공매도추이요청 송신" & "(" & stockName & ")", "Opt10014_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10015_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String, ByVal startDate As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10015_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.SetInputValue("시작일자", startDate)
        AxKH.CommRqData("일별거래상세요청", "Opt10015", "0", screenNum)
        Logger(LoggerType.NotRealData, "일별거래상세요청 송신" & "(" & stockName & ")", "Opt10015_OnReceiveTrData", stockCode)

    End Sub

    Public Sub Opt10081_OnReceiveTrData(ByVal stockCode As String, ByVal stockName As String, ByVal stdDate As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT1, "Opt10001_OnReceiveTrData", stockCode)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("종목코드", stockCode)
        AxKH.SetInputValue("기준일자", stdDate)
        ' 0 or 1, 수신데이터 1:유상증자, 2:무상증자, 4:배당락, 8:액면분할, 16:액면병합, 32:기업합병, 64:감자, 256:권리락
        AxKH.SetInputValue("수정주가구분", 1)
        AxKH.CommRqData("주식일봉차트조회", "OPT10081", "0", screenNum)

        Logger(LoggerType.NotRealData, "주식일봉차트조회 송신" & "(" & stockName & ")", "Opt10081_OnReceiveTrData", stockCode)

    End Sub
#End Region

#Region " 계좌 "
    Public Sub Opt10012_OnReceiveTrData(ByVal accNo As String)
        Dim screenNum As String = ScreenNoManage(Enum_ScreenNo.TR_OPT2, "Opt10012_OnReceiveTrData", accNo)

        If screenNum = "" Then Exit Sub

        AxKH.SetInputValue("계좌번호", accNo)
        AxKH.CommRqData("주문체결요청", "Opt10012", "0", screenNum)
        Logger(LoggerType.NotRealData, "주문체결요청 송신" & "(" & accNo & ")", "Opt10012_OnReceiveTrData", accNo)

    End Sub
#End Region

#Region " 시장 정보 "
    ''' <summary>
    ''' 신고저가요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="newHighLowGb">신고저구분 = 1 : 신고가, 2 : 신저가()</param>
    ''' <param name="highLowGb">고저종구분 = 1 : 고저기준, 2 : 종가기준()</param>
    ''' <param name="stockJoguen">종목조건 = 0 : 전체조회, 1 : 관리종목제외, 3 : 우선주제외, 5 : 증100제외, 6 : 증100만보기, 7 : 증40만보기, 8 : 증30만보기()</param>
    ''' <param name="volumeGb">거래량구분 = 00000:전체조회, 00010:만주이상, 00050:5만주이상, 00100:10만주이상, 00150:15만주이상, 00200:20만주이상, 00300:30만주이상, 00500:50만주이상, 01000:백만주이상</param>
    ''' <param name="loanJoguen">신용조건 = 0 : 전체조회, 1 : 신용융자A군, 2 : 신용융자B군, 3 : 신용융자C군, 4 : 신용융자D군, 9 : 신용융자전체()</param>
    ''' <param name="sangHahanIn">상하한포함 = 0 : 미포함, 1 : 포함()</param>
    ''' <param name="stdDate">기간 = 5:5일, 10:10일, 20:20일, 60:60일, 250:250일, 250일까지 입력가능</param>
    ''' <remarks></remarks>
    Public Sub Opt10016_OnReceiveTrData(ByVal marketGb As String, ByVal newHighLowGb As String, ByVal highLowGb As String, ByVal stockJoguen As String, _
                                        ByVal volumeGb As String, ByVal loanJoguen As String, ByVal sangHahanIn As String, ByVal stdDate As String)

        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("신고저구분", newHighLowGb)
        AxKH.SetInputValue("고저종구분", highLowGb)
        AxKH.SetInputValue("종목조건", stockJoguen)
        AxKH.SetInputValue("거래량구분", volumeGb)
        AxKH.SetInputValue("신용조건", loanJoguen)
        AxKH.SetInputValue("상하한포함", sangHahanIn)
        AxKH.SetInputValue("기간", stdDate)
        AxKH.CommRqData("신고저가요청", "Opt10016", "0", "4016")
        Logger(LoggerType.NotRealData, "신고저가요청 송신" & "(Opt10016)", "Opt10016_OnReceiveTrData", "Opt10016")

    End Sub
    ''' <summary>
    ''' 상하한가요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="sangHahanInGb">상하한구분 = 1:상한, 2:상승, 3:보합, 4: 하한, 5:하락, 6:전일상한, 7:전일하한</param>
    ''' <param name="sortGb">정렬구분 = 1:종목코드순, 2:연속횟수순(상위100개), 3:등락률순</param>
    ''' <param name="stockGb">종목조건 = 0:전체조회,1:관리종목제외, 3:우선주제외, 4:우선주+관리종목제외, 5:증100제외, 6:증100만 보기, 7:증40만 보기, 8:증30만 보기, 9:증20만 보기, 10:우선주+관리종목+환기종목제외</param>
    ''' <param name="volumeGb">거래량구분 = 00000:전체조회, 00010:만주이상, 00050:5만주이상, 00100:10만주이상, 00150:15만주이상, 00200:20만주이상, 00300:30만주이상, 00500:50만주이상, 01000:백만주이상</param>
    ''' <param name="loadGb">신용조건 = 0:전체조회, 1:신용융자A군, 2:신용융자B군, 3:신용융자C군, 4:신용융자D군, 9:신용융자전체</param>
    ''' <param name="maemaegumeGb">매매금구분 = 0:전체조회, 1:1천원미만, 2:1천원~2천원, 3:2천원~3천원, 4:5천원~1만원, 5:1만원이상, 8:1천원이상</param>
    ''' <remarks></remarks>
    Public Sub Opt10017_OnReceiveTrData(ByVal marketGb As String, ByVal sangHahanInGb As String, ByVal sortGb As String, ByVal stockGb As String, _
                                        ByVal volumeGb As String, ByVal loadGb As String, ByVal maemaegumeGb As String)



        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("상하한구분", sangHahanInGb)
        AxKH.SetInputValue("정렬구분", sortGb)
        AxKH.SetInputValue("종목조건", stockGb)
        AxKH.SetInputValue("거래량구분", volumeGb)
        AxKH.SetInputValue("신용조건", loadGb)
        AxKH.SetInputValue("매매금구분", maemaegumeGb)
        AxKH.CommRqData("상하한가요청", "Opt10017", "0", "4017")
        Logger(LoggerType.NotRealData, "상하한가요청 송신" & "(Opt10017)", "Opt10017_OnReceiveTrData", "Opt10017")

    End Sub
    ''' <summary>
    ''' 고저가근접요청
    ''' </summary>
    ''' <param name="highlowGb">고저구분 = 1:고가, 2:저가</param>
    ''' <param name="approachGb">근접율 = 05:0.5 10:1.0, 15:1.5, 20:2.0. 25:2.5, 30:3.0</param>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="volumeGb">거래량구분 = 00000:전체조회, 00010:만주이상, 00050:5만주이상, 00100:10만주이상, 00150:15만주이상, 00200:20만주이상, 00300:30만주이상, 00500:50만주이상, 01000:백만주이상</param>
    ''' <param name="stockJoguen">종목조건 = 0:전체조회,1:관리종목제외, 3:우선주제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기</param>
    ''' <param name="loanJoguen">신용조건 = 0:전체조회, 1:신용융자A군, 2:신용융자B군, 3:신용융자C군, 4:신용융자D군, 9:신용융자전체</param>
    ''' <remarks></remarks>
    Public Sub Opt10018_OnReceiveTrData(ByVal highlowGb As String, ByVal approachGb As String, ByVal marketGb As String, ByVal volumeGb As String, _
                                        ByVal stockJoguen As String, ByVal loanJoguen As String)


        AxKH.SetInputValue("고저구분", highlowGb)
        AxKH.SetInputValue("근접율", approachGb)
        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("거래량구분", volumeGb)
        AxKH.SetInputValue("종목조건", "입력값 5")
        AxKH.SetInputValue("신용조건", "입력값 6")
        AxKH.CommRqData("고저가근접요청", "Opt10018", "0", "4018")
        Logger(LoggerType.NotRealData, "고저가근접요청 송신" & "(Opt10018)", "Opt10018_OnReceiveTrData", "Opt10018")

    End Sub
    ''' <summary>
    ''' 가격급등락요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥, 201:코스피200</param>
    ''' <param name="upDownGb">등락구분 = 1:급등, 2:급락</param>
    ''' <param name="timeGb">시간구분 = 1:분전, 2:일전</param>
    ''' <param name="time">시간 = 분 혹은 일입력</param>
    ''' <param name="volumeGb">거래량구분 = 00000:전체조회, 00010:만주이상, 00050:5만주이상, 00100:10만주이상, 00150:15만주이상, 00200:20만주이상, 00300:30만주이상, 00500:50만주이상, 01000:백만주이상</param>
    ''' <param name="stockJoguen">종목조건 = 0:전체조회,1:관리종목제외, 3:우선주제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기</param>
    ''' <param name="loanJoguen">신용조건 = 0:전체조회, 1:신용융자A군, 2:신용융자B군, 3:신용융자C군, 4:신용융자D군, 9:신용융자전체</param>
    ''' <param name="priceJoguen">가격조건 = 0:전체조회, 1:1천원미만, 2:1천원~2천원, 3:2천원~3천원, 4:5천원~1만원, 5:1만원이상, 8:1천원이상</param>
    ''' <param name="sangHahanIn">상하한포함 = 0:미포함, 1:포함</param>
    ''' <remarks></remarks>
    Public Sub Opt10019_OnReceiveTrData(ByVal marketGb As String, ByVal upDownGb As String, ByVal timeGb As String, ByVal time As String, _
                                        ByVal volumeGb As String, ByVal stockJoguen As String, ByVal loanJoguen As String, ByVal priceJoguen As String, _
                                        ByVal sangHahanIn As String)

        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("등락구분", upDownGb)
        AxKH.SetInputValue("시간구분", timeGb)
        AxKH.SetInputValue("시간", time)
        AxKH.SetInputValue("거래량구분", volumeGb)
        AxKH.SetInputValue("종목조건", stockJoguen)
        AxKH.SetInputValue("신용조건", loanJoguen)
        AxKH.SetInputValue("가격조건", priceJoguen)
        AxKH.SetInputValue("상하한포함", sangHahanIn)
        AxKH.CommRqData("가격급등락요청", "Opt10019", "0", "4019")
        Logger(LoggerType.NotRealData, "가격급등락요청 송신" & "(Opt10019)", "Opt10019_OnReceiveTrData", "Opt10019")

    End Sub
    ''' <summary>
    ''' 호가잔량상위요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 001:코스피, 101:코스닥</param>
    ''' <param name="sortGb">정렬구분 = 1:순매수잔량순, 2:순매도잔량순, 3:매수비율순, 4:매도비율순</param>
    ''' <param name="volumeGb">거래량구분 = 0000:장시작전(0주이상), 0010:만주이상, 0050:5만주이상, 00100:10만주이상</param>
    ''' <param name="stockJoguen">종목조건 = 0:전체조회, 1:관리종목제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기, 9:증20만보기</param>
    ''' <param name="loanJoguen">신용조건 = 0:전체조회, 1:신용융자A군, 2:신용융자B군, 3:신용융자C군, 4:신용융자D군, 9:신용융자전체</param>
    ''' <remarks></remarks>
    Public Sub Opt10020_OnReceiveTrData(ByVal marketGb As String, ByVal sortGb As String, ByVal volumeGb As String, ByVal stockJoguen As String, ByVal loanJoguen As String)

        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("정렬구분", sortGb)
        AxKH.SetInputValue("거래량구분", volumeGb)
        AxKH.SetInputValue("종목조건", stockJoguen)
        AxKH.SetInputValue("신용조건", loanJoguen)
        AxKH.CommRqData("호가잔량상위요청", "Opt10020", "0", "4020")
        Logger(LoggerType.NotRealData, "호가잔량상위요청 송신" & "(Opt10020)", "Opt10020_OnReceiveTrData", "Opt10020")

    End Sub
    ''' <summary>
    ''' 호가잔량급증요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 001:코스피, 101:코스닥</param>
    ''' <param name="meameaGb">매매구분 = 1:매수잔량, 2:매도잔량</param>
    ''' <param name="sortGb">정렬구분 = 1:급증량, 2:급증률</param>
    ''' <param name="timeGb">시간구분 = 분 입력</param>
    ''' <param name="volumeGb">거래량구분 = 1:천주이상, 5:5천주이상, 10:만주이상, 50:5만주이상, 100:10만주이상</param>
    ''' <param name="stockJoguenGb">종목조건 = 0:전체조회, 1:관리종목제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기, 9:증20만보기</param>
    ''' <remarks></remarks>
    Public Sub Opt10021_OnReceiveTrData(ByVal marketGb As String, ByVal meameaGb As String, ByVal sortGb As String, ByVal timeGb As String, ByVal volumeGb As String, ByVal stockJoguenGb As String)

        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("매매구분", meameaGb)
        AxKH.SetInputValue("정렬구분", sortGb)
        AxKH.SetInputValue("시간구분", timeGb)
        AxKH.SetInputValue("거래량구분", volumeGb)
        AxKH.SetInputValue("종목조건", stockJoguenGb)
        AxKH.CommRqData("호가잔량급증요청", "Opt10021", "0", "4021")
        Logger(LoggerType.NotRealData, "호가잔량급증요청 송신" & "(Opt10021)", "Opt10021_OnReceiveTrData", "Opt10021")

    End Sub
    ''' <summary>
    ''' 잔량율급증요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 001:코스피, 101:코스닥</param>
    ''' <param name="rateGb">비율구분 = 1:매수/매도비율, 2:매도/매수비율</param>
    ''' <param name="timeGb">시간구분 = 분 입력</param>
    ''' <param name="volumeGb">거래량구분 = 5:5천주이상, 10:만주이상, 50:5만주이상, 100:10만주이상</param>
    ''' <param name="stockJoguenGb">종목조건 = 0:전체조회, 1:관리종목제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기, 9:증20만보기</param>
    ''' <remarks></remarks>
    Public Sub Opt10022_OnReceiveTrData(ByVal marketGb As String, ByVal rateGb As String, ByVal timeGb As String, ByVal volumeGb As String, ByVal stockJoguenGb As String)

        AxKH.SetInputValue("시장구분", "입력값 1")
        AxKH.SetInputValue("비율구분", "입력값 2")
        AxKH.SetInputValue("시간구분", "입력값 3")
        AxKH.SetInputValue("거래량구분", "입력값 4")
        AxKH.SetInputValue("종목조건", "입력값 5")
        AxKH.CommRqData("잔량율급증요청", "Opt10022", "0", "4022")
        Logger(LoggerType.NotRealData, "잔량율급증요청 송신" & "(Opt10022)", "Opt10022_OnReceiveTrData", "Opt10022")

    End Sub
    ''' <summary>
    ''' 거래량급증요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="sortGb">정렬구분 = 1:급증량, 2:급증률</param>
    ''' <param name="timeGb">시간구분 = 1:분, 2:전일</param>
    ''' <param name="volumeGb">거래량구분 = 5:5천주이상, 10:만주이상, 50:5만주이상, 100:10만주이상, 200:20만주이상, 300:30만주이상, 500:50만주이상, 1000:백만주이상</param>
    ''' <param name="time">시간 = 분 입력</param>
    ''' <param name="stockJoguenGb">종목조건 = 0:전체조회, 1:관리종목제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기, 9:증20만보기</param>
    ''' <param name="priceGb">가격구분 = 0:전체조회, 2:5만원이상, 5:1만원이상, 6:5천원이상, 8:1천원이상, 9:10만원이상</param>
    ''' <remarks></remarks>
    Public Sub Opt10023_OnReceiveTrData(ByVal marketGb As String, ByVal sortGb As String, ByVal timeGb As String, ByVal volumeGb As String, _
                                        ByVal time As String, ByVal stockJoguenGb As String, ByVal priceGb As String)

        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("정렬구분", sortGb)
        AxKH.SetInputValue("시간구분", timeGb)
        AxKH.SetInputValue("거래량구분", volumeGb)
        AxKH.SetInputValue("시간", time)
        AxKH.SetInputValue("종목조건", stockJoguenGb)
        AxKH.SetInputValue("가격구분", priceGb)
        AxKH.CommRqData("거래량급증요청", "Opt10023", "0", "4023")
        Logger(LoggerType.NotRealData, "거래량급증요청 송신" & "(Opt10023)", "Opt10023_OnReceiveTrData", "Opt10023")

    End Sub
    ''' <summary>
    ''' 거래량갱신요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="jugiGb">주기구분 = 5:5일, 10:10일, 20:20일, 60:60일, 250:250일</param>
    ''' <param name="volumeGb">거래량구분 = 5:5천주이상, 10:만주이상, 50:5만주이상, 100:10만주이상, 200:20만주이상, 300:30만주이상, 500:50만주이상, 1000:백만주이상</param>
    ''' <remarks></remarks>
    Public Sub Opt10024_OnReceiveTrData(ByVal marketGb As String, ByVal jugiGb As String, ByVal volumeGb As String)


        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("주기구분", jugiGb)
        AxKH.SetInputValue("거래량구분", volumeGb)
        AxKH.CommRqData("거래량갱신요청", "Opt10024", "0", "4024")
        Logger(LoggerType.NotRealData, "거래량갱신요청 송신" & "(Opt10024)", "Opt10024_OnReceiveTrData", "Opt10024")

    End Sub
    ''' <summary>
    ''' 매물대집중요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="mamulPointRate">매물집중비율 = 0~100 입력</param>
    ''' <param name="currentPriceJinIp">현재가진입 = 0:현재가 매물대 집입 포함안함, 1:현재가 매물대 집입포함</param>
    ''' <param name="mamulDaeSu">매물대수 = 숫자입력</param>
    ''' <param name="jugiGb">주기구분 = 50:50일, 100:100일, 150:150일, 200:200일, 250:250일, 300:300일</param>
    ''' <remarks></remarks>
    Public Sub Opt10025_OnReceiveTrData(ByVal marketGb As String, ByVal mamulPointRate As String, ByVal currentPriceJinIp As String, _
                                        ByVal mamulDaeSu As String, ByVal jugiGb As String)


        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("매물집중비율", mamulPointRate)
        AxKH.SetInputValue("현재가진입", currentPriceJinIp)
        AxKH.SetInputValue("매물대수", mamulDaeSu)
        AxKH.SetInputValue("주기구분", jugiGb)
        AxKH.CommRqData("매물대집중요청", "Opt10025", "0", "4025")
        Logger(LoggerType.NotRealData, "매물대집중요청 송신" & "(Opt10025)", "Opt10025_OnReceiveTrData", "Opt10025")

    End Sub
    ''' <summary>
    ''' 고저PER요청
    ''' </summary>
    ''' <param name="perGb">고저PER요청</param>
    ''' <remarks></remarks>
    Public Sub Opt10026_OnReceiveTrData(ByVal perGb As String)


        AxKH.SetInputValue("PER구분", perGb)
        AxKH.CommRqData("고저PER요청", "Opt10026", "0", "4026")
        Logger(LoggerType.NotRealData, "고저PER요청 송신" & "(Opt10026)", "Opt10026_OnReceiveTrData", "Opt10026")

    End Sub
    ''' <summary>
    ''' 전일대비등락률상위요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="sortGb">정렬구분 = 1:상승률, 2:상승폭, 3:하락률, 4:하락폭</param>
    ''' <param name="volumeJoguen">거래량조건 = 0000:전체조회, 0010:만주이상, 0050:5만주이상, 0100:10만주이상, 0150:15만주이상, 0200:20만주이상, 0300:30만주이상, 0500:50만주이상, 1000:백만주이상</param>
    ''' <param name="stockJoguen">종목조건 = 0:전체조회, 1:관리종목제외, 4:우선주+관리주제외, 3:우선주제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기, 9:증20만보기, 11:정리매매종목제외</param>
    ''' <param name="loadJoguen">신용조건 = 0:전체조회, 1:신용융자A군, 2:신용융자B군, 3:신용융자C군, 4:신용융자D군, 9:신용융자전체</param>
    ''' <param name="sangHahanIn">상하한포함 = 0:불 포함, 1:포함</param>
    ''' <param name="priceJoguen">가격조건 = 0:전체조회, 1:1천원미만, 2:1천원~2천원, 3:2천원~5천원, 4:5천원~1만원, 5:1만원이상, 8:1천원이상</param>
    ''' <param name="tradeDaeGumJoguen">거래대금조건 = 0:전체조회, 3:3천만원이상, 5:5천만원이상, 10:1억원이상, 30:3억원이상, 50:5억원이상, 100:10억원이상, 300:30억원이상, 500:50억원이상, 1000:100억원이상, 3000:300억원이상, 5000:500억원이상</param>
    ''' <remarks></remarks>
    Public Sub Opt10027_OnReceiveTrData(ByVal marketGb As String, ByVal sortGb As String, ByVal volumeJoguen As String, _
                                        ByVal stockJoguen As String, ByVal loadJoguen As String, ByVal sangHahanIn As String, _
                                        ByVal priceJoguen As String, ByVal tradeDaeGumJoguen As String)

        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("정렬구분", sortGb)
        AxKH.SetInputValue("거래량조건", volumeJoguen)
        AxKH.SetInputValue("종목조건", stockJoguen)
        AxKH.SetInputValue("신용조건", loadJoguen)
        AxKH.SetInputValue("상하한포함", sangHahanIn)
        AxKH.SetInputValue("가격조건", priceJoguen)
        AxKH.SetInputValue("거래대금조건", tradeDaeGumJoguen)
        AxKH.CommRqData("전일대비등락률상위요청", "Opt10027", "0", "4027")
        Logger(LoggerType.NotRealData, "전일대비등락률상위요청 송신" & "(Opt10027)", "Opt10027_OnReceiveTrData", "Opt10027")

    End Sub
    ''' <summary>
    ''' 전일대비등락률상위요청
    ''' </summary>
    ''' <param name="sortGb">정렬구분 = 1:시가, 2:고가, 3:저가, 4:기준가</param>
    ''' <param name="volumeJoguen">거래량조건 = 0000:전체조회, 0010:만주이상, 0050:5만주이상, 0100:10만주이상, 0500:50만주이상, 1000:백만주이상</param>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="sangHahanIn">상하한포함 = 0:불 포함, 1:포함</param>
    ''' <param name="stockJoguen">종목조건 = 0:전체조회, 1:관리종목제외, 4:우선주+관리주제외, 3:우선주제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기, 9:증20만보기</param>
    ''' <param name="loadJoguen">신용조건 = 0:전체조회, 1:신용융자A군, 2:신용융자B군, 3:신용융자C군, 4:신용융자D군, 9:신용융자전체</param>
    ''' <param name="tradeDaeGumJoguen">거래대금조건 = 0:전체조회, 3:3천만원이상, 5:5천만원이상, 10:1억원이상, 30:3억원이상, 50:5억원이상, 100:10억원이상, 300:30억원이상, 500:50억원이상, 1000:100억원이상, 3000:300억원이상, 5000:500억원이상</param>
    ''' <param name="updownJoguen">등락조건 = 1:상위, 2:하위</param>
    ''' <remarks></remarks>
    Public Sub Opt10028_OnReceiveTrData(ByVal sortGb As String, ByVal volumeJoguen As String, ByVal marketGb As String, _
                                        ByVal sangHahanIn As String, ByVal stockJoguen As String, ByVal loadJoguen As String, _
                                        ByVal tradeDaeGumJoguen As String, ByVal updownJoguen As String)

        AxKH.SetInputValue("정렬구분", sortGb)
        AxKH.SetInputValue("거래량조건", volumeJoguen)
        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("상하한포함", sangHahanIn)
        AxKH.SetInputValue("종목조건", stockJoguen)
        AxKH.SetInputValue("신용조건", loadJoguen)
        AxKH.SetInputValue("거래대금조건", tradeDaeGumJoguen)
        AxKH.SetInputValue("등락조건", updownJoguen)
        AxKH.CommRqData("전일대비등락률상위요청", "Opt10028", "0", "4028")
        Logger(LoggerType.NotRealData, "전일대비등락률상위요청 송신" & "(Opt10028)", "Opt10028_OnReceiveTrData", "Opt10028")

    End Sub
    ''' <summary>
    ''' 예상체결등락률상위요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="sortGb">정렬구분 = 1:상승률, 2:상승폭, 3:보합, 4:하락률,5:하락폭, 6, 체결량, 7:상한, 8:하한</param>
    ''' <param name="volumeJoguen">거래량조건 = 0:전체조회, 1;천주이상, 3:3천주, 5:5천주, 10:만주이상, 50:5만주이상, 100:10만주이상</param>
    ''' <param name="stockJoguen">종목조건 = 0:전체조회, 1:관리종목제외, 3:우선주제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기, 9:증20만보기, 11:정리매매종목제외</param>
    ''' <param name="loadJoguen">신용조건 = 0:전체조회, 1:신용융자A군, 2:신용융자B군, 3:신용융자C군, 4:신용융자D군, 9:신용융자전체</param>
    ''' <param name="priceJoguen">가격조건 = 0:전체조회, 1:1천원미만, 2:1천원~2천원, 3:2천원~5천원, 4:5천원~1만원, 5:1만원이상, 8:1천원이상</param>
    ''' <remarks></remarks>
    Public Sub Opt10029_OnReceiveTrData(ByVal marketGb As String, ByVal sortGb As String, ByVal volumeJoguen As String, _
                                    ByVal stockJoguen As String, ByVal loadJoguen As String, ByVal priceJoguen As String)


        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("정렬구분", sortGb)
        AxKH.SetInputValue("거래량조건", volumeJoguen)
        AxKH.SetInputValue("종목조건", stockJoguen)
        AxKH.SetInputValue("신용조건", loadJoguen)
        AxKH.SetInputValue("가격조건", priceJoguen)

        AxKH.CommRqData(" 예상체결등락률상위요청", "Opt10029", "0", "4029")
        Logger(LoggerType.NotRealData, " 예상체결등락률상위요청 송신" & "(Opt10029)", "Opt10029_OnReceiveTrData", "Opt10029")

    End Sub
    ''' <summary>
    ''' 당일거래량상위요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="sortGb">정렬구분 = 1:거래량, 2:거래회전율, 3:거래대금</param>
    ''' <param name="manageStockIn">관리종목포함 = 0:관리종목 포함, 1:관리종목 미포함</param>
    ''' <remarks></remarks>
    Public Sub Opt10030_OnReceiveTrData(ByVal marketGb As String, ByVal sortGb As String, ByVal manageStockIn As String)


        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("정렬구분", sortGb)
        AxKH.SetInputValue("관리종목포함", manageStockIn)
        AxKH.CommRqData(" 당일거래량상위요청", "Opt10030", "0", "4030")
        Logger(LoggerType.NotRealData, " 당일거래량상위요청 송신" & "(Opt10030)", "Opt10030_OnReceiveTrData", "Opt10030")

    End Sub
    ''' <summary>
    ''' 전일거래량상위요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="searchGb">조회구분 = 1:전일거래량 상위100종목, 2:전일거래대금 상위100종목</param>
    ''' <param name="fromRank">순위시작 = 0 ~ 100 값 중에  조회를 원하는 순위 시작값</param>
    ''' <param name="toRank">순위끝 = 0 ~ 100 값 중에  조회를 원하는 순위 끝값</param>
    ''' <remarks></remarks>
    Public Sub Opt10031_OnReceiveTrData(ByVal marketGb As String, ByVal searchGb As String, ByVal fromRank As String, ByVal toRank As String)


        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("조회구분", searchGb)
        AxKH.SetInputValue("순위시작", fromRank)
        AxKH.SetInputValue("순위끝", toRank)
        AxKH.CommRqData(" 전일거래량상위요청", "Opt10031", "0", "4031")
        Logger(LoggerType.NotRealData, " 전일거래량상위요청 송신" & "(Opt10031)", "Opt10031_OnReceiveTrData", "Opt10031")

    End Sub
    ''' <summary>
    ''' 거래대금상위요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="manageStockIn">관리종목포함 = 0:관리종목 미포함, 1:관리종목 포함</param>
    ''' <remarks></remarks>
    Public Sub Opt10032_OnReceiveTrData(ByVal marketGb As String, ByVal manageStockIn As String)

        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("관리종목포함", manageStockIn)
        AxKH.CommRqData(" 거래대금상위요청", "Opt10032", "0", "4032")
        Logger(LoggerType.NotRealData, " 거래대금상위요청 송신" & "(Opt10032)", "Opt10032_OnReceiveTrData", "Opt10032")

    End Sub
    ''' <summary>
    ''' 신용비율상위요청
    ''' </summary>
    ''' <param name="marketGb">시장구분 = 000:전체, 001:코스피, 101:코스닥</param>
    ''' <param name="volumeGb">거래량구분 = 0:전체조회, 10:만주이상, 50:5만주이상, 100:10만주이상, 200:20만주이상, 300:30만주이상, 500:50만주이상, 1000:백만주이상</param>
    ''' <param name="stockJoguen">종목조건 = 0:전체조회, 1:관리종목제외, 5:증100제외, 6:증100만보기, 7:증40만보기, 8:증30만보기, 9:증20만보기</param>
    ''' <param name="sangHanGb">상하한포함 = 0:상하한 미포함, 1:상하한포함</param>
    ''' <param name="loanJoguen">신용조건 = 0:전체조회, 1:신용융자A군, 2:신용융자B군, 3:신용융자C군, 4:신용융자D군, 9:신용융자전체</param>
    ''' <remarks></remarks>
    Public Sub Opt10033_OnReceiveTrData(ByVal marketGb As String, ByVal volumeGb As String, ByVal stockJoguen As String, ByVal sangHanGb As String, ByVal loanJoguen As String)

        AxKH.SetInputValue("시장구분", marketGb)
        AxKH.SetInputValue("거래량구분", volumeGb)
        AxKH.SetInputValue("종목조건", stockJoguen)
        AxKH.SetInputValue("상하한포함", sangHanGb)
        AxKH.SetInputValue("신용조건", loanJoguen)
        AxKH.CommRqData(" 신용비율상위요청", "Opt10033", "0", "4033")
        Logger(LoggerType.NotRealData, " 신용비율상위요청 송신" & "(Opt10033)", "Opt10033_OnReceiveTrData", "Opt10033")

    End Sub
#End Region

#End Region

#Region " ※ AxKH_Event "

#Region " 접속(OnEventConnect) "
    Private Sub AxKH_OnEventConnect(ByVal sender As Object, ByVal e As AxKHOpenAPILib._DKHOpenAPIEvents_OnEventConnectEvent) Handles AxKH.OnEventConnect
        If KOAError.IsError(e.nErrCode) = False Then
            Logger(LoggerType.Connect, KOAError.GetErrorMassage, "AxKH_OnEventConnect", "")
            lblLoginStatus.Text = "로그인 실패"
            _allStockDataset.Reset()
            _KospiStockDataset.Reset()
            _KosDakStockDataset.Reset()

            _loginStatus = LoginStatus.DisConnect

            RaiseEvent OnEventConnect("로그인 실패")

        Else
            Logger(LoggerType.Connect, KOAError.GetErrorMassage, "AxKH_OnEventConnect", "")
            lblLoginStatus.Text = "로그인 성공"
            _allStockDataset = _clsKiwoomBaseInfo.GetStockListByMarKetAll(AxKH)
            _KospiStockDataset = _clsKiwoomBaseInfo.GetStockListByMarKetKospi(AxKH)
            _KosDakStockDataset = _clsKiwoomBaseInfo.GetStockListByMarKetKosDak(AxKH)

            _loginStatus = LoginStatus.Connect

            RaiseEvent OnEventConnect("로그인 성공")

        End If
    End Sub

    Public Event OnEventConnect(ByVal status As String)

#End Region

#Region " 수신 메시지 이벤트(OnReceiveMsg)"
    ''' <summary>
    ''' 수신 메시지 이벤트
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Private Sub AxKH_OnReceiveMsg(sender As Object, e As AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveMsgEvent) Handles AxKH.OnReceiveMsg
        Logger(LoggerType.OnMsg, "=================<< 서버 메시지 >>=====================", "OnReceiveMsg", "")
        Logger(LoggerType.OnMsg, "1. 화면번호:" & e.sScrNo & "2. RQName:" & e.sRQName, e.sTrCode, e.sMsg)

        RaiseEvent OnReceiveMsg("1. 화면번호:" & e.sScrNo & "2. RQName:" & e.sRQName & "3. TrName : " & e.sTrCode & "4. 메세지:" & e.sMsg)

    End Sub

    Public Event OnReceiveMsg(ByVal msg As String)
#End Region

#Region " 주문 접수/확인 수신시 이벤트(OnReceiveChejanData)  "
    ''' <summary>
    ''' 주문 접수/확인 수신시 이벤트
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Private Sub AxKH_OnReceiveChejanData(sender As Object, e As AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveChejanDataEvent) Handles AxKH.OnReceiveChejanData

    End Sub

    Public Event OnReceiveChejanData(ByVal ds As DataSet)
#End Region

#Region " 로컬에 사용자조건식 저장 성공여부 응답 이벤트(로컬에 사용자조건식 저장 성공여부 응답 이벤트) "
    Private _clsConditionSearch As New clsConditionSearch

    ''' <summary>
    ''' 로컬에 사용자조건식 저장 성공여부 응답 이벤트
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Private Sub AxKH_OnReceiveConditionVer(sender As Object, e As AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveConditionVerEvent) Handles AxKH.OnReceiveConditionVer
        If e.lRet <> 1 Then Exit Sub

        Dim strList As String = AxKH.GetConditionNameList()
        RaiseEvent OnReceiveConditionVer(_clsConditionSearch.SetUserConditionList(strList))
    End Sub

    Public Event OnReceiveConditionVer(ByVal ds As DataSet)
#End Region

#Region " 조건검색 조회응답 이벤트(OnReceiveTrCondition) "
    ''' <summary>
    ''' 조건검색 조회응답 이벤트
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Private Sub AxKH_OnReceiveTrCondition(sender As Object, e As AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrConditionEvent) Handles AxKH.OnReceiveTrCondition
        If Trim(e.strCodeList) <> "" Then
            RaiseEvent OnReceiveTrCondition(_clsConditionSearch.SetUserConditionStockList(e.strCodeList, AxKH))
        End If
    End Sub

    Public Event OnReceiveTrCondition(ByVal ds As DataSet)

#End Region

#Region " 조건검색 조회응답 이벤트(OnReceiveRealCondition) "
    ''' <summary>
    '''  조건검색 조회응답 이벤트
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Private Sub AxKH_OnReceiveRealCondition(sender As Object, e As AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveRealConditionEvent) Handles AxKH.OnReceiveRealCondition

    End Sub

    Public Event OnReceiveRealCondition(ByVal ds As DataSet)
#End Region

#Region " 실시간 시세 이벤트(OnReceiveRealData) "
    ''' <summary>
    ''' 실시간 시세 이벤트
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Private Sub AxKH_OnReceiveRealData(sender As Object, e As AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveRealDataEvent) Handles AxKH.OnReceiveRealData
        Select Case Trim(e.sRealData)
            Case ""
        End Select
    End Sub

    Public Event OnReceiveRealData(ByVal ds As DataSet)
#End Region

#Region " Tran 수신시 이벤트(OnReceiveTrData) "
    Public Event OnReceiveTrCondition(ByVal ds As DataSet)

    ''' <summary>
    ''' Tran 수신시 이벤트
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Private Sub AxKH_OnReceiveTrData(sender As Object, e As AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveTrDataEvent) Handles AxKH.OnReceiveTrData

    End Sub

    Public Event OnReceiveTrData(ByVal ds As DataSet)
#End Region

#Region " ? (OnReceiveInvestRealData) "
    ''' <summary>
    ''' ?
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Private Sub AxKH_OnReceiveInvestRealData(sender As Object, e As AxKHOpenAPILib._DKHOpenAPIEvents_OnReceiveInvestRealDataEvent) Handles AxKH.OnReceiveInvestRealData

    End Sub

    Public Event OnReceiveInvestRealData(ByVal ds As DataSet)
#End Region

#End Region

End Class
